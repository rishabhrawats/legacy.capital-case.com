
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="e5499b48-ffe4-564d-9c3b-070c2ed3b8bf")}catch(e){}}();
(()=>{"use strict";const e="10.1.0",t=globalThis;function n(){return r(t),t}function r(t){const n=t.__SENTRY__=t.__SENTRY__||{};return n.version=n.version||e,n[e]=n[e]||{}}function i(n,r,i=t){const o=i.__SENTRY__=i.__SENTRY__||{},s=o[e]=o[e]||{};return s[n]||(s[n]=r())}const o="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,s=Object.prototype.toString;function a(e){switch(s.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return v(e,Error)}}function c(e,t){return s.call(e)===`[object ${t}]`}function u(e){return c(e,"ErrorEvent")}function l(e){return c(e,"DOMError")}function d(e){return c(e,"String")}function p(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function f(e){return c(e,"Object")}function h(e){return"undefined"!=typeof Event&&v(e,Event)}function g(e){return Boolean(e?.then&&"function"==typeof e.then)}function v(e,t){try{return e instanceof t}catch{return!1}}const m=t,b=80;function y(e,t){const n=e,r=[];if(!n?.tagName)return"";if(m.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const i=t?.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(i?.length)i.forEach((e=>{r.push(`[${e[0]}="${e[1]}"]`)}));else{n.id&&r.push(`#${n.id}`);const e=n.className;if(e&&d(e)){const t=e.split(/\s+/);for(const e of t)r.push(`.${e}`)}}const o=["aria-label","type","name","title","alt"];for(const e of o){const t=n.getAttribute(e);t&&r.push(`[${e}="${t}"]`)}return r.join("")}const _={};function w(e){if(!("console"in t))return e();const n=t.console,r={},i=Object.keys(_);i.forEach((e=>{const t=_[e];r[e]=n[e],n[e]=t}));try{return e()}finally{i.forEach((e=>{n[e]=r[e]}))}}function S(){return O().enabled}function E(...e){I("error",...e)}function I(e,...n){o&&S()&&w((()=>{t.console[e](`Sentry Logger [${e}]:`,...n)}))}function O(){return o?i("loggerSettings",(()=>({enabled:!1}))):{enabled:!1}}const x={enable:function(){O().enabled=!0},disable:function(){O().enabled=!1},isEnabled:S,log:function(...e){I("log",...e)},warn:function(...e){I("warn",...e)},error:function(...e){I("error",...e)}};function C(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function k(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{o&&x.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function T(e){if(a(e))return{message:e.message,name:e.name,stack:e.stack,...P(e)};if(h(e)){const t={type:e.type,target:A(e.target),currentTarget:A(e.currentTarget),...P(e)};return"undefined"!=typeof CustomEvent&&v(e,CustomEvent)&&(t.detail=e.detail),t}return e}function A(e){try{return"undefined"!=typeof Element&&v(e,Element)?function(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,i=[];let o=0,s=0;const a=" > ",c=a.length;let u;const l=Array.isArray(t)?t:t.keyAttrs,d=!Array.isArray(t)&&t.maxStringLength||b;for(;n&&o++<r&&(u=y(n,l),!("html"===u||o>1&&s+i.length*c+u.length>=d));)i.push(u),s+=u.length,n=n.parentNode;return i.reverse().join(a)}catch{return"<unknown>"}}(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function P(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function D(e=function(){const e=t;return e.crypto||e.msCrypto}()){let n=()=>16*Math.random();try{if(e?.randomUUID)return e.randomUUID().replace(/-/g,"");e?.getRandomValues&&(n=()=>{const t=new Uint8Array(1);return e.getRandomValues(t),t[0]})}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function R(e,t,n){const r=e.exception=e.exception||{},i=r.values=r.values||[],o=i[0]=i[0]||{};o.value||(o.value=t||""),o.type||(o.type=n||"Error")}function F(e,t){const n=function(e){return e.exception?.values?.[0]}(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...r?.data,...t.data};n.mechanism.data=e}}function N(e){if(function(e){try{return e.__sentry_captured__}catch{}}(e))return!0;try{k(e,"__sentry_captured__",!0)}catch{}return!1}const M=1e3;function L(){return Date.now()/M}let U;function z(){return(U??(U=function(){const{performance:e}=t;if(!e?.now||!e.timeOrigin)return L;const n=e.timeOrigin;return()=>(n+e.now())/M}()))()}function j(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||z(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:D()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function $(e,t,n=2){if(!t||"object"!=typeof t||n<=0)return t;if(e&&0===Object.keys(t).length)return e;const r={...e};for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=$(r[e],t[e],n-1));return r}function V(){return D()}function B(){return D().substring(16)}const H="_sentrySpan";function W(e,t){t?k(e,H,t):delete e[H]}function K(e){return e[H]}class G{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:V(),sampleRand:Math.random()}}clone(){const e=new G;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,W(e,K(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&j(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e,n=t instanceof G?t.getScopeData():f(t)?e:void 0,{tags:r,extra:i,user:o,contexts:s,level:a,fingerprint:c=[],propagationContext:u}=n||{};return this._tags={...this._tags,...r},this._extra={...this._extra,...i},this._contexts={...this._contexts,...s},o&&Object.keys(o).length&&(this._user=o),a&&(this._level=a),c.length&&(this._fingerprint=c),u&&(this._propagationContext=u),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,W(this,void 0),this._attachments=[],this.setPropagationContext({traceId:V(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const r={timestamp:L(),...e,message:e.message?C(e.message,2048):e.message};return this._breadcrumbs.push(r),this._breadcrumbs.length>n&&(this._breadcrumbs=this._breadcrumbs.slice(-n),this._client?.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:K(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=$(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t?.event_id||D();if(!this._client)return o&&x.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},this),n}captureMessage(e,t,n){const r=n?.event_id||D();if(!this._client)return o&&x.warn("No client configured on scope - will not capture message!"),r;const i=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:i,...n,event_id:r},this),r}captureEvent(e,t){const n=t?.event_id||D();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(o&&x.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}class Y{constructor(e,t){let n,r;n=e||new G,r=t||new G,this._stack=[{scope:n}],this._isolationScope=r}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(e){throw this._popScope(),e}return g(n)?n.then((e=>(this._popScope(),e)),(e=>{throw this._popScope(),e})):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1||!this._stack.pop())}}function q(){const e=r(n());return e.stack=e.stack||new Y(i("defaultCurrentScope",(()=>new G)),i("defaultIsolationScope",(()=>new G)))}function J(e){return q().withScope(e)}function X(e,t){const n=q();return n.withScope((()=>(n.getStackTop().scope=e,t(e))))}function Z(e){return q().withScope((()=>e(q().getIsolationScope())))}function Q(e){const t=r(e);return t.acs?t.acs:{withIsolationScope:Z,withScope:J,withSetScope:X,withSetIsolationScope:(e,t)=>Z(t),getCurrentScope:()=>q().getScope(),getIsolationScope:()=>q().getIsolationScope()}}function ee(){return Q(n()).getCurrentScope()}function te(){return Q(n()).getIsolationScope()}function ne(){return ee().getClient()}function re(e){const t=e.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:i}=t,o={trace_id:n,span_id:i||B()};return r&&(o.parent_span_id=r),o}function ie(e,t){te().setTag(e,t)}const oe="production",se=/^o(\d+)\./,ae=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function ce(e,t=!1){const{host:n,path:r,pass:i,port:o,projectId:s,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&i?`:${i}`:""}@${n}${o?`:${o}`:""}/${r?`${r}/`:r}${s}`}function ue(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function le(e){const t=e.getOptions(),{host:n}=e.getDsn()||{};let r;return t.orgId?r=String(t.orgId):n&&(r=function(e){const t=e.match(se);return t?.[1]}(n)),r}const de="?",pe=/\(error: (.*)\)/,fe=/captureMessage|captureException/;function he(e){return e[e.length-1]||{}}const ge="<anonymous>";function ve(e,t=100,n=1/0){try{return be("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function me(e,t=3,n=102400){const r=ve(e,t);return i=r,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(i))>n?me(e,t-1,n):r;var i}function be(e,t,n=1/0,r=1/0,i=function(){const e=new WeakSet;return[function(t){return!!e.has(t)||(e.add(t),!1)},function(t){e.delete(t)}]}()){const[o,s]=i;if(null==t||["boolean","string"].includes(typeof t)||"number"==typeof t&&Number.isFinite(t))return t;const a=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if("object"==typeof(n=t)&&null!==n&&(n.__isVue||n._isVue))return"[VueViewModel]";if(function(e){return f(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}(t))return"[SyntheticEvent]";if("number"==typeof t&&!Number.isFinite(t))return`[${t}]`;if("function"==typeof t)return`[Function: ${function(e){try{return e&&"function"==typeof e&&e.name||ge}catch{return ge}}(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return t?.constructor?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var n}(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return a.replace("object ","");if(o(t))return"[Circular ~]";const u=t;if(u&&"function"==typeof u.toJSON)try{return be("",u.toJSON(),c-1,r,i)}catch{}const l=Array.isArray(t)?[]:{};let d=0;const p=T(t);for(const e in p){if(!Object.prototype.hasOwnProperty.call(p,e))continue;if(d>=r){l[e]="[MaxProperties ~]";break}const t=p[e];l[e]=be(e,t,c-1,r,i),d++}return s(t),l}function ye(e,t=[]){return[e,t]}function _e(e,t){const[n,r]=e;return[n,[...r,t]]}function we(e,t){const n=e[1];for(const e of n)if(t(e,e[0].type))return!0;return!1}function Se(e){const n=r(t);return n.encodePolyfill?n.encodePolyfill(e):(new TextEncoder).encode(e)}function Ee(e){const[t,n]=e;let r=JSON.stringify(t);function i(e){"string"==typeof r?r="string"==typeof e?r+e:[Se(r),e]:r.push("string"==typeof e?Se(e):e)}for(const e of n){const[t,n]=e;if(i(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)i(n);else{let e;try{e=JSON.stringify(n)}catch{e=JSON.stringify(ve(n))}i(e)}}return"string"==typeof r?r:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}(r)}function Ie(e){const t="string"==typeof e.data?Se(e.data):e.data;return[{type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType},t]}const Oe={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item"};function xe(e){return Oe[e]}function Ce(e){if(!e?.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}const ke=[];function Te(e,t){for(const n of t)n?.afterAllSetup&&n.afterAllSetup(e)}function Ae(e,t,n){if(n[t.name])o&&x.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===ke.indexOf(t.name)&&"function"==typeof t.setupOnce&&(t.setupOnce(),ke.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",((t,r)=>n(t,r,e)))}if("function"==typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign(((t,r)=>n(t,r,e)),{id:t.name});e.addEventProcessor(r)}o&&x.log(`Integration installed: ${t.name}`)}}const Pe="sentry.source",De="sentry.sample_rate",Re="sentry.previous_trace_sample_rate",Fe="sentry.op",Ne="sentry.origin",Me="sentry.profile_id",Le="sentry.exclusive_time",Ue="sentry-",ze=/^sentry-/;function je(e){return e.split(",").map((e=>e.split("=").map((e=>{try{return decodeURIComponent(e.trim())}catch{return}})))).reduce(((e,[t,n])=>(t&&n&&(e[t]=n),e)),{})}const $e=0,Ve=1,Be="_sentryScope",He="_sentryIsolationScope";function We(e){return{scope:e[Be],isolationScope:e[He]}}const Ke=1;let Ge=!1;function Ye(e){const{spanId:t,traceId:n,isRemote:r}=e.spanContext(),i=r?t:Ze(e).parent_span_id,o=We(e).scope;return{parent_span_id:i,span_id:r?o?.getPropagationContext().propagationSpanId||B():t,trace_id:n}}function qe(e){return e&&e.length>0?e.map((({context:{spanId:e,traceId:t,traceFlags:n,...r},attributes:i})=>({span_id:e,trace_id:t,sampled:n===Ke,attributes:i,...r}))):void 0}function Je(e){return"number"==typeof e?Xe(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?Xe(e.getTime()):z()}function Xe(e){return e>9999999999?e/1e3:e}function Ze(e){if(function(e){return"function"==typeof e.getSpanJSON}(e))return e.getSpanJSON();const{spanId:t,traceId:n}=e.spanContext();if(function(e){const t=e;return!!(t.attributes&&t.startTime&&t.name&&t.endTime&&t.status)}(e)){const{attributes:r,startTime:i,name:o,endTime:s,status:a,links:c}=e;return{span_id:t,trace_id:n,data:r,description:o,parent_span_id:"parentSpanId"in e?e.parentSpanId:"parentSpanContext"in e?e.parentSpanContext?.spanId:void 0,start_timestamp:Je(i),timestamp:Je(s)||void 0,status:Qe(a),op:r[Fe],origin:r[Ne],links:qe(c)}}return{span_id:t,trace_id:n,start_timestamp:0,data:{}}}function Qe(e){if(e&&e.code!==$e)return e.code===Ve?"ok":e.message||"unknown_error"}const et="_sentryRootSpan";function tt(e){return e[et]||e}function nt(){Ge||(w((()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")})),Ge=!0)}const rt="_frozenDsc";function it(e,t){const n=t.getOptions(),{publicKey:r}=t.getDsn()||{},i={environment:n.environment||oe,release:n.release,public_key:r,trace_id:e,org_id:le(t)};return t.emit("createDsc",i),i}function ot(e){const t=ne();if(!t)return{};const n=tt(e),r=Ze(n),i=r.data,o=n.spanContext().traceState,s=o?.get("sentry.sample_rate")??i[De]??i[Re];function a(e){return"number"!=typeof s&&"string"!=typeof s||(e.sample_rate=`${s}`),e}const c=n[rt];if(c)return a(c);const u=o?.get("sentry.dsc"),l=u&&function(e){const t=function(e){if(e&&(d(e)||Array.isArray(e)))return Array.isArray(e)?e.reduce(((e,t)=>{const n=je(t);return Object.entries(n).forEach((([t,n])=>{e[t]=n})),e}),{}):je(e)}(e);if(!t)return;const n=Object.entries(t).reduce(((e,[t,n])=>(t.match(ze)&&(e[t.slice(Ue.length)]=n),e)),{});return Object.keys(n).length>0?n:void 0}(u);if(l)return a(l);const p=it(e.spanContext().traceId,t),f=i[Pe],h=r.description;return"url"!==f&&h&&(p.transaction=h),function(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=ne()?.getOptions();return!(!t||null==t.tracesSampleRate&&!t.tracesSampler)}()&&(p.sampled=String(function(e){const{traceFlags:t}=e.spanContext();return t===Ke}(n)),p.sample_rand=o?.get("sentry.sample_rand")??We(n).scope?.getPropagationContext().sampleRand.toString()),a(p),t.emit("createDsc",p,n),p}function st(e){return new ct((t=>{t(e)}))}function at(e){return new ct(((t,n)=>{n(e)}))}class ct{constructor(e){this._state=0,this._handlers=[],this._runExecutor(e)}then(e,t){return new ct(((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){r(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new ct(((t,n)=>{let r,i;return this.then((t=>{i=!1,r=t,e&&e()}),(t=>{i=!0,r=t,e&&e()})).then((()=>{i?n(r):t(r)}))}))}_executeHandlers(){if(0===this._state)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(1===this._state&&e[1](this._value),2===this._state&&e[2](this._value),e[0]=!0)}))}_runExecutor(e){const t=(e,t)=>{0===this._state&&(g(t)?t.then(n,r):(this._state=e,this._value=t,this._executeHandlers()))},n=e=>{t(1,e)},r=e=>{t(2,e)};try{e(n,r)}catch(e){r(e)}}}function ut(e,t,n,r=0){return new ct(((i,s)=>{const a=e[r];if(null===t||"function"!=typeof a)i(t);else{const c=a({...t},n);o&&a.id&&null===c&&x.log(`Event processor "${a.id}" dropped event`),g(c)?c.then((t=>ut(e,t,n,r+1).then(i))).then(null,s):ut(e,c,n,r+1).then(i).then(null,s)}}))}function lt(e,t){const{extra:n,tags:r,user:i,contexts:o,level:s,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:d,propagationContext:p,transactionName:f,span:h}=t;dt(e,"extra",n),dt(e,"tags",r),dt(e,"user",i),dt(e,"contexts",o),e.sdkProcessingMetadata=$(e.sdkProcessingMetadata,a,2),s&&(e.level=s),f&&(e.transactionName=f),h&&(e.span=h),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),u.length&&(e.fingerprint=[...e.fingerprint,...u]),l.length&&(e.eventProcessors=[...e.eventProcessors,...l]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext={...e.propagationContext,...p}}function dt(e,t,n){e[t]=$(e[t],n,1)}let pt,ft,ht;function gt(e,n,r,o,s,a){const{normalizeDepth:c=3,normalizeMaxBreadth:u=1e3}=e,l={...n,event_id:n.event_id||r.event_id||D(),timestamp:n.timestamp||L()},d=r.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:r,dist:i,maxValueLength:o=250}=t;e.environment=e.environment||n||oe,!e.release&&r&&(e.release=r),!e.dist&&i&&(e.dist=i);const s=e.request;s?.url&&(s.url=C(s.url,o))}(l,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(l,d),s&&s.emit("applyFrameMetadata",n),void 0===n.type&&function(e,n){const r=function(e){const n=t._sentryDebugIds;if(!n)return{};const r=Object.keys(n);return ht&&r.length===ft||(ft=r.length,ht=r.reduce(((t,r)=>{pt||(pt={});const i=pt[r];if(i)t[i[0]]=i[1];else{const i=e(r);for(let e=i.length-1;e>=0;e--){const o=i[e],s=o?.filename,a=n[r];if(s&&a){t[s]=a,pt[r]=[s,a];break}}}return t}),{})),ht}(n);e.exception?.values?.forEach((e=>{e.stacktrace?.frames?.forEach((e=>{e.filename&&(e.debug_id=r[e.filename])}))}))}(l,e.stackParser);const p=function(e,t){if(!t)return e;const n=e?e.clone():new G;return n.update(t),n}(o,r.captureContext);r.mechanism&&F(l,r.mechanism);const f=s?s.getEventProcessors():[],h=i("globalScope",(()=>new G)).getScopeData();a&&lt(h,a.getScopeData()),p&&lt(h,p.getScopeData());const g=[...r.attachments||[],...h.attachments];return g.length&&(r.attachments=g),function(e,t){const{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:o}=t;!function(e,t){const{extra:n,tags:r,user:i,contexts:o,level:s,transactionName:a}=t;Object.keys(n).length&&(e.extra={...n,...e.extra}),Object.keys(r).length&&(e.tags={...r,...e.tags}),Object.keys(i).length&&(e.user={...i,...e.user}),Object.keys(o).length&&(e.contexts={...o,...e.contexts}),s&&(e.level=s),a&&"transaction"!==e.type&&(e.transaction=a)}(e,t),r&&function(e,t){e.contexts={trace:Ye(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:ot(t),...e.sdkProcessingMetadata};const n=Ze(tt(t)).description;n&&!e.transaction&&"transaction"===e.type&&(e.transaction=n)}(e,r),function(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint.length||delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,i),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,o)}(l,h),ut([...f,...h.eventProcessors],l,r).then((e=>(e&&function(e){const t={};if(e.exception?.values?.forEach((e=>{e.stacktrace?.frames?.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))})),0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach((([e,t])=>{n.push({type:"sourcemap",code_file:e,debug_id:t})}))}(e),"number"==typeof c&&c>0?function(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:ve(e.data,t,n)}})))},...e.user&&{user:ve(e.user,t,n)},...e.contexts&&{contexts:ve(e.contexts,t,n)},...e.extra&&{extra:ve(e.extra,t,n)}};return e.contexts?.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=ve(e.contexts.trace.data,t,n))),e.spans&&(r.spans=e.spans.map((e=>({...e,...e.data&&{data:ve(e.data,t,n)}})))),e.contexts?.flags&&r.contexts&&(r.contexts.flags=ve(e.contexts.flags,3,n)),r}(e,c,u):e)))}const vt="Not capturing exception because it's already been captured.",mt="Discarded session because of missing or non-string release",bt=Symbol.for("SentryInternalError"),yt=Symbol.for("SentryDoNotSendEventError");function _t(e){return{message:e,[bt]:!0}}function wt(e){return{message:e,[yt]:!0}}function St(e){return!!e&&"object"==typeof e&&bt in e}function Et(e){return!!e&&"object"==typeof e&&yt in e}class It{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=function(e){const t="string"==typeof e?function(e){const t=ae.exec(e);if(!t)return void w((()=>{console.error(`Invalid Sentry Dsn: ${e}`)}));const[n,r,i="",o="",s="",a=""]=t.slice(1);let c="",u=a;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const e=u.match(/^\d+/);e&&(u=e[0])}return ue({host:o,pass:i,path:c,projectId:u,port:s,protocol:n,publicKey:r})}(e):ue(e);if(t&&function(e){if(!o)return!0;const{port:t,projectId:n,protocol:r}=e;return!(["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(x.error(`Invalid Sentry Dsn: ${t} missing`),!0)))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(r)?t&&isNaN(parseInt(t,10))&&(x.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(x.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(x.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}(e.dsn):o&&x.warn("No DSN provided, client will not send events."),this._dsn){const i=(t=this._dsn,n=e.tunnel,r=e._metadata?e._metadata.sdk:void 0,n||`${function(e){return`${function(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}(e)}${e.projectId}/envelope/`}(t)}?${function(e,t){const n={sentry_version:"7"};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}(t,r)}`);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:i})}var t,n,r}captureException(e,t,n){const r=D();if(N(e))return o&&x.log(vt),r;const i={event_id:r,...t};return this._process(this.eventFromException(e,i).then((e=>this._captureEvent(e,i,n)))),i.event_id}captureMessage(e,t,n,r){const i={event_id:D(),...n},o=p(e)?e:String(e),s=null===(a=e)||p(a)||"object"!=typeof a&&"function"!=typeof a?this.eventFromMessage(o,t,i):this.eventFromException(e,i);var a;return this._process(s.then((e=>this._captureEvent(e,i,r)))),i.event_id}captureEvent(e,t,n){const r=D();if(t?.originalException&&N(t.originalException))return o&&x.log(vt),r;const i={event_id:r,...t},s=e.sdkProcessingMetadata||{},a=s.capturedSpanScope,c=s.capturedSpanIsolationScope;return this._process(this._captureEvent(e,i,a||n,c)),i.event_id}captureSession(e){this.sendSession(e),j(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e))))):st(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,this.emit("close"),e)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some((({name:e})=>e.startsWith("Spotlight"))))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];Ae(this,e,this._integrations),t||Te(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=function(e,t,n,r){const i=Ce(n),o=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n?.sdk);const s=function(e,t,n,r){const i=e.sdkProcessingMetadata?.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:ce(r)},...i&&{trace:i}}}(e,i,r,t);return delete e.sdkProcessingMetadata,ye(s,[[{type:o},e]])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=_e(n,Ie(e));const r=this.sendEnvelope(n);r&&r.then((t=>this.emit("afterSendEvent",e,t)),null)}sendSession(e){const{release:t,environment:n=oe}=this._options;if("aggregates"in e){const r=e.attrs||{};if(!r.release&&!t)return void(o&&x.warn(mt));r.release=r.release||t,r.environment=r.environment||n,e.attrs=r}else{if(!e.release&&!t)return void(o&&x.warn(mt));e.release=e.release||t,e.environment=e.environment||n}this.emit("beforeSendSession",e);const r=function(e,t,n,r){const i=Ce(n);return ye({sent_at:(new Date).toISOString(),...i&&{sdk:i},...!!r&&t&&{dsn:ce(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(r)}recordDroppedEvent(e,t,n=1){if(this._options.sendClientReports){const r=`${e}:${t}`;o&&x.log(`Recording outcome: "${r}"${n>1?` (${n} times)`:""}`),this._outcomes[r]=(this._outcomes[r]||0)+n}}on(e,t){const n=this._hooks[e]=this._hooks[e]||[];return n.push(t),()=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)}}emit(e,...t){const n=this._hooks[e];n&&n.forEach((e=>e(...t)))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,(e=>(o&&x.error("Error while sending envelope:",e),e))):(o&&x.error("Transport disabled"),st({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(e,t){const n={};return t.forEach((t=>{t&&Ae(e,t,n)})),n}(this,e),Te(this,e)}_updateSessionFromEvent(e,t){let n="fatal"===t.level,r=!1;const i=t.exception?.values;if(i){r=!0;for(const e of i){const t=e.mechanism;if(!1===t?.handled){n=!0;break}}}const o="ok"===e.status;(o&&0===e.errors||o&&n)&&(j(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new ct((t=>{let n=0;const r=setInterval((()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,r){const i=this.getOptions(),o=Object.keys(this._integrations);return!t.integrations&&o?.length&&(t.integrations=o),this.emit("preprocessEvent",e,t),e.type||r.setLastEventId(e.event_id||t.event_id),gt(i,e,t,n,this,r).then((e=>{if(null===e)return e;this.emit("postprocessEvent",e,t),e.contexts={trace:re(n),...e.contexts};const r=function(e,t){const n=t.getPropagationContext();return n.dsc||it(n.traceId,e)}(this,n);return e.sdkProcessingMetadata={dynamicSamplingContext:r,...e.sdkProcessingMetadata},e}))}_captureEvent(e,t={},n=ee(),r=te()){return o&&Ot(e)&&x.log(`Captured error event \`${function(e){const t=[];e.message&&t.push(e.message);try{const n=e.exception.values[e.exception.values.length-1];n?.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`))}catch{}return t}(e)[0]||"<unknown>"}\``),this._processEvent(e,t,n,r).then((e=>e.event_id),(e=>{o&&(Et(e)?x.log(e.message):St(e)?x.warn(e.message):x.warn(e))}))}_processEvent(e,t,n,r){const i=this.getOptions(),{sampleRate:o}=i,s=xt(e),a=Ot(e),c=e.type||"error",u=`before send for type \`${c}\``,l=void 0===o?void 0:function(e){if("boolean"==typeof e)return Number(e);const t="string"==typeof e?parseFloat(e):e;return"number"!=typeof t||isNaN(t)||t<0||t>1?void 0:t}(o);if(a&&"number"==typeof l&&Math.random()>l)return this.recordDroppedEvent("sample_rate","error"),at(wt(`Discarding event because it's not included in the random sample (sampling rate = ${o})`));const d="replay_event"===c?"replay":c;return this._prepareEvent(e,t,n,r).then((e=>{if(null===e)throw this.recordDroppedEvent("event_processor",d),wt("An event processor returned `null`, will not send event.");if(t.data&&!0===t.data.__sentry__)return e;const n=function(e,t,n,r){const{beforeSend:i,beforeSendTransaction:o,beforeSendSpan:s}=t;let a=n;if(Ot(a)&&i)return i(a,r);if(xt(a)){if(s){const e=s(function(e){const{trace_id:t,parent_span_id:n,span_id:r,status:i,origin:o,data:s,op:a}=e.contexts?.trace??{};return{data:s??{},description:e.transaction,op:a,parent_span_id:n,span_id:r??"",start_timestamp:e.start_timestamp??0,status:i,timestamp:e.timestamp,trace_id:t??"",origin:o,profile_id:s?.[Me],exclusive_time:s?.[Le],measurements:e.measurements,is_segment:!0}}(a));if(e?a=$(n,{type:"transaction",timestamp:(c=e).timestamp,start_timestamp:c.start_timestamp,transaction:c.description,contexts:{trace:{trace_id:c.trace_id,span_id:c.span_id,parent_span_id:c.parent_span_id,op:c.op,status:c.status,origin:c.origin,data:{...c.data,...c.profile_id&&{[Me]:c.profile_id},...c.exclusive_time&&{[Le]:c.exclusive_time}}}},measurements:c.measurements}):nt(),a.spans){const e=[];for(const t of a.spans){const n=s(t);n?e.push(n):(nt(),e.push(t))}a.spans=e}}if(o){if(a.spans){const e=a.spans.length;a.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:e}}return o(a,r)}}var c;return a}(0,i,e,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(g(e))return e.then((e=>{if(!f(e)&&null!==e)throw _t(n);return e}),(e=>{throw _t(`${t} rejected with ${e}`)}));if(!f(e)&&null!==e)throw _t(n);return e}(n,u)})).then((i=>{if(null===i){if(this.recordDroppedEvent("before_send",d),s){const t=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",t)}throw wt(`${u} returned \`null\`, will not send event.`)}const o=n.getSession()||r.getSession();if(a&&o&&this._updateSessionFromEvent(o,i),s){const e=(i.sdkProcessingMetadata?.spanCountBeforeProcessing||0)-(i.spans?i.spans.length:0);e>0&&this.recordDroppedEvent("before_send","span",e)}const c=i.transaction_info;if(s&&c&&i.transaction!==e.transaction){const e="custom";i.transaction_info={...c,source:e}}return this.sendEvent(i,t),i})).then(null,(e=>{if(Et(e)||St(e))throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),_t(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map((([e,t])=>{const[n,r]=e.split(":");return{reason:n,category:r,quantity:t}}))}_flushOutcomes(){o&&x.log("Flushing outcomes...");const e=this._clearOutcomes();if(0===e.length)return void(o&&x.log("No outcomes to send"));if(!this._dsn)return void(o&&x.log("No dsn provided, will not send outcomes"));o&&x.log("Sending outcomes:",e);const t=(n=e,ye((r=this._options.tunnel&&ce(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:L(),discarded_events:n}]]));var n,r;this.sendEnvelope(t)}}function Ot(e){return void 0===e.type}function xt(e){return"transaction"===e.type}function Ct(e,t){const n=t??function(e){return kt().get(e)}(e)??[];if(0===n.length)return;const r=e.getOptions(),i=function(e,t,n,r){const i={};return t?.sdk&&(i.sdk={name:t.sdk.name,version:t.sdk.version}),n&&r&&(i.dsn=ce(r)),ye(i,[(o=e,[{type:"log",item_count:o.length,content_type:"application/vnd.sentry.items.log+json"},{items:o}])]);var o}(n,r._metadata,r.tunnel,e.getDsn());kt().set(e,[]),e.emit("flushLogs"),e.sendEnvelope(i)}function kt(){return i("clientToLogBufferMap",(()=>new WeakMap))}function Tt(e){void 0===e.user?.ip_address&&(e.user={...e.user,ip_address:"{{auto}}"})}function At(e){"aggregates"in e?void 0===e.attrs?.ip_address&&(e.attrs={...e.attrs,ip_address:"{{auto}}"}):void 0===e.ipAddress&&(e.ipAddress="{{auto}}")}function Pt(e,t){const n=Rt(e,t),r={type:Mt(t),value:Lt(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function Dt(e,t){return{exception:{values:[Pt(e,t)]}}}function Rt(e,t){const n=t.stacktrace||t.stack||"",r=function(e){return e&&Ft.test(e.message)?1:0}(t),i=function(e){return"number"==typeof e.framesToPop?e.framesToPop:0}(t);try{return e(n,r,i)}catch{}return[]}const Ft=/Minified React error #\d+;/i;function Nt(e){return"undefined"!=typeof WebAssembly&&void 0!==WebAssembly.Exception&&e instanceof WebAssembly.Exception}function Mt(e){const t=e?.name;return!t&&Nt(e)?e.message&&Array.isArray(e.message)&&2==e.message.length?e.message[0]:"WebAssembly.Exception":t}function Lt(e){const t=e?.message;return Nt(e)?Array.isArray(e.message)&&2==e.message.length?e.message[1]:"wasm exception":t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function Ut(e,t,n,r){const i=function(e,t,n,r,i){let o;if(u(t)&&t.error)return Dt(e,t.error);if(l(t)||c(t,"DOMException")){const i=t;if("stack"in t)o=Dt(e,t);else{const t=i.name||(l(i)?"DOMError":"DOMException"),s=i.message?`${t}: ${i.message}`:t;o=zt(e,s,n,r),R(o,s)}return"code"in i&&(o.tags={...o.tags,"DOMException.code":`${i.code}`}),o}return a(t)?Dt(e,t):f(t)||h(t)?(o=function(e,t,n,r){const i=ne(),o=i?.getOptions().normalizeDepth,s=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}}(t),a={__serialized__:me(t,o)};if(s)return{exception:{values:[Pt(e,s)]},extra:a};const c={exception:{values:[{type:h(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:jt(t,{isUnhandledRejection:r})}]},extra:a};if(n){const t=Rt(e,n);t.length&&(c.exception.values[0].stacktrace={frames:t})}return c}(e,t,n,void 0),F(o,{synthetic:!0}),o):(o=zt(e,t,n,r),R(o,`${t}`,void 0),F(o,{synthetic:!0}),o)}(e,t,n?.syntheticException||void 0,r);return F(i),i.level="error",n?.event_id&&(i.event_id=n.event_id),st(i)}function zt(e,t,n,r){const i={};if(r&&n){const r=Rt(e,n);r.length&&(i.exception={values:[{value:t,stacktrace:{frames:r}}]}),F(i,{synthetic:!0})}if(p(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return i.logentry={message:e,params:n},i}return i.message=t,i}function jt(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(T(e));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=t)return C(r,t);for(let e=n.length;e>0;e--){const r=n.slice(0,e).join(", ");if(!(r.length>t))return e===n.length?r:C(r,t)}return""}(e),r=t?"promise rejection":"exception";return u(e)?`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``:h(e)?`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}(e)}\` (type=${e.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}const $t=t,Vt=Symbol.for("SentryBufferFullError");const Bt=6e4;function Ht(e,t,n=function(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]||Promise.resolve(void 0)}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return at(Vt);const i=r();return-1===t.indexOf(i)&&t.push(i),i.then((()=>n(i))).then(null,(()=>n(i).then(null,(()=>{})))),i},drain:function(e){return new ct(((n,r)=>{let i=t.length;if(!i)return n(!0);const o=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{st(e).then((()=>{--i||(clearTimeout(o),n(!0))}),r)}))}))}}}(e.bufferSize||64)){let r={};return{send:function(i){const s=[];if(we(i,((t,n)=>{const i=xe(n);!function(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}(r,i)?s.push(t):e.recordDroppedEvent("ratelimit_backoff",i)})),0===s.length)return st({});const a=ye(i[0],s),c=t=>{we(a,((n,r)=>{e.recordDroppedEvent(t,xe(r))}))};return n.add((()=>t({body:Ee(a)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&o&&x.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=function(e,{statusCode:t,headers:n},r=Date.now()){const i={...e},o=n?.["x-sentry-rate-limits"],s=n?.["retry-after"];if(o)for(const e of o.trim().split(",")){const[t,n,,,o]=e.split(":",5),s=parseInt(t,10),a=1e3*(isNaN(s)?60:s);if(n)for(const e of n.split(";"))"metric_bucket"===e&&o&&!o.split(";").includes("custom")||(i[e]=r+a);else i.all=r+a}else s?i.all=r+function(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?Bt:r-t}(s,r):429===t&&(i.all=r+6e4);return i}(r,e),e)),(e=>{throw c("network_error"),o&&x.error("Encountered error running transport request:",e),e})))).then((e=>e),(e=>{if(e===Vt)return o&&x.error("Skipped sending event because buffer is full."),c("queue_overflow"),st({});throw e}))},flush:e=>n.drain(e)}}const Wt="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Kt=t,Gt={};function Yt(e){Gt[e]=void 0}function qt(e,t,n,r){const i={filename:e,function:"<anonymous>"===t?de:t,in_app:!0};return void 0!==n&&(i.lineno=n),void 0!==r&&(i.colno=r),i}const Jt=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Xt=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Zt=/\((\S*)(?::(\d+))(?::(\d+))\)/,Qt=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,en=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,tn=function(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0,r=0)=>{const i=[],o=e.split("\n");for(let e=n;e<o.length;e++){let n=o[e];n.length>1024&&(n=n.slice(0,1024));const s=pe.test(n)?n.replace(pe,"$1"):n;if(!s.match(/\S*Error: /)){for(const e of t){const t=e(s);if(t){i.push(t);break}}if(i.length>=50+r)break}}return function(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(he(t).function||"")&&t.pop(),t.reverse(),fe.test(he(t).function||"")&&(t.pop(),fe.test(he(t).function||"")&&t.pop()),t.slice(0,50).map((e=>({...e,filename:e.filename||he(t).filename,function:e.function||de})))}(i.slice(r))}}([30,e=>{const t=Jt.exec(e);if(t){const[,e,n,r]=t;return qt(e,de,+n,+r)}const n=Xt.exec(e);if(n){if(n[2]&&0===n[2].indexOf("eval")){const e=Zt.exec(n[2]);e&&(n[2]=e[1],n[3]=e[2],n[4]=e[3])}const[e,t]=nn(n[1]||de,n[2]);return qt(t,e,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}}],[50,e=>{const t=Qt.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=en.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||de;return[n,e]=nn(n,e),qt(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}]),nn=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:de,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};var rn,on=/bot|crawl|http|lighthouse|scan|search|spider/i;var sn,an,cn,un,ln,dn,pn,fn=(sn=function(e,t){return sn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},sn(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}sn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),hn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},gn=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};!function(e){e.PHONE="PHONE",e.TABLET="TABLET",e.DESKTOP="DESKTOP"}(an||(an={})),function(e){e.MAC_OS="MAC_OS",e.IOS="IOS",e.WINDOWS="WINDOWS",e.ANDROID="ANDROID",e.LINUX="LINUX"}(cn||(cn={})),function(e){e.OPERA="OPERA",e.FIREFOX="FIREFOX",e.SAFARI="SAFARI",e.IE="IE",e.EDGE="EDGE",e.CHROME="CHROME"}(un||(un={})),function(e){e.AB="AB",e.SPLIT="SPLIT",e.PERSONALIZATION="PERSONALIZATION"}(ln||(ln={})),function(e){e.LEGACY_CLICK_SUBMIT="LEGACY_CLICK_SUBMIT",e.CLICK="CLICK",e.SUBMIT="SUBMIT",e.PAGE_VIEW="PAGE_VIEW",e.SCROLL_DEPTH="SCROLL_DEPTH",e.TIME_ON_PAGE="TIME_ON_PAGE",e.PROGRAMMATIC="PROGRAMMATIC"}(dn||(dn={})),function(e){e.PIXELS="PIXELS",e.PERCENTAGE="PERCENTAGE"}(pn||(pn={})),ie("url",window.location.href);var vn=new class extends It{constructor(t){const n=(r=t,{release:"string"==typeof __SENTRY_RELEASE__?__SENTRY_RELEASE__:$t.SENTRY_RELEASE?.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...r});var r;!function(t,n,r=[n],i="npm"){const o=t._metadata||{};o.sdk||(o.sdk={name:`sentry.javascript.${n}`,packages:r.map((t=>({name:`${i}:@sentry/${t}`,version:e}))),version:e}),t._metadata=o}(n,"browser",["browser"],$t.SENTRY_SDK_SOURCE||"npm"),super(n);const{sendDefaultPii:i,sendClientReports:o,enableLogs:s}=this._options;$t.document&&(o||s)&&$t.document.addEventListener("visibilitychange",(()=>{"hidden"===$t.document.visibilityState&&(o&&this._flushOutcomes(),s&&Ct(this))})),s&&(this.on("flush",(()=>{Ct(this)})),this.on("afterCaptureLog",(()=>{this._logFlushIdleTimeout&&clearTimeout(this._logFlushIdleTimeout),this._logFlushIdleTimeout=setTimeout((()=>{Ct(this)}),5e3)}))),i&&(this.on("postprocessEvent",Tt),this.on("beforeSendSession",At))}eventFromException(e,t){return Ut(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(e,t,n="info",r,i){const o=zt(e,t,r?.syntheticException||void 0,i);return o.level=n,r?.event_id&&(o.event_id=r.event_id),st(o)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}_prepareEvent(e,t,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n,r)}}({dsn:"https://3266931c85fced597df7d2c3891c380a@o4506872303845376.ingest.us.sentry.io/4506882884370432",transport:function(e,t=function(e){const t=Gt[e];if(t)return t;let n=Kt[e];if((r=n)&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(r.toString()))return Gt[e]=n.bind(Kt);var r;const i=Kt.document;if(i&&"function"==typeof i.createElement)try{const t=i.createElement("iframe");t.hidden=!0,i.head.appendChild(t);const r=t.contentWindow;r?.[e]&&(n=r[e]),i.head.removeChild(t)}catch(t){Wt&&x.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,t)}return n?Gt[e]=n.bind(Kt):n}("fetch")){let n=0,r=0;return Ht(e,(function(i){const o=i.body.length;n+=o,r++;const s={body:i.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};if(!t)return Yt("fetch"),at("No fetch implementation available");try{return t(e.url,s).then((e=>(n-=o,r--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))}catch(e){return Yt("fetch"),n-=o,r--,at(e)}}))},stackParser:tn,integrations:[],environment:"production"}),mn=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return fn(t,e),t}(Error);try{!function(){if(window.optibaseScriptLoaded)throw new mn("[Optibase] Detected duplicated Optibase Script.");function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];T&&console.log.apply(console,function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}(["[Optibase ".concat(e,"]:")],t,!1))}function t(){var e,t;return(null===(e=window.optibaseSubscriptionPlan)||void 0===e?void 0:e.includes("PROFESSIONAL"))||(null===(t=window.optibaseSubscriptionPlan)||void 0===t?void 0:t.includes("CUSTOM"))}function n(){var e,t;return(null===(e=window.optibaseSubscriptionPlan)||void 0===e?void 0:e.includes("PROFESSIONAL"))||(null===(t=window.optibaseSubscriptionPlan)||void 0===t?void 0:t.includes("CUSTOM"))}function r(e){var t;return null!==(t=null==e?void 0:e.some((function(e){return e.test.recordingsEnabled&&e.eligible})))&&void 0!==t&&t}function i(){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf("edge")>-1||t.indexOf("edg")>-1?un.EDGE:t.indexOf("opr")>-1&&window.opr?un.OPERA:t.indexOf("chrome")>-1&&window.chrome?un.CHROME:t.indexOf("trident")>-1?un.IE:t.indexOf("firefox")>-1?un.FIREFOX:t.indexOf("safari")>-1?un.SAFARI:void 0;return e("metadata","Current Browser: ".concat(n,".")),n}function o(){var t=window.navigator.userAgent,n=window.navigator.platform,r=void 0;return/Macintosh|MacIntel|MacPPC|Mac68K|Darwin/.test(n)?r=cn.MAC_OS:/iPhone|iPad|iPod/.test(n)?r=cn.IOS:/Win32|Win64|Windows|WinCE/.test(n)?r=cn.WINDOWS:/Android/.test(t)?r=cn.ANDROID:/Linux/.test(n)&&(r=cn.LINUX),e("metadata","Current OS: ".concat(r,".")),r}function s(){var t=window.innerWidth<=767?an.PHONE:window.innerWidth<=990?an.TABLET:an.DESKTOP;return e("metadata","Current Screen Size: ".concat(t,".")),t}function a(e){try{var t=new URL(e.startsWith("http")?e:"https://".concat(e));return t.origin+t.pathname}catch(e){return null}}var c=document.createElement("style");function u(){var t;e("showBody","Showing body."),null===(t=c.parentNode)||void 0===t||t.removeChild(c)}function l(t,n){return hn(this,void 0,void 0,(function(){var r,i,o,s,a,c;return gn(this,(function(u){switch(u.label){case 0:return e("getInitialize","Fetching active for publicApiKey: ".concat(N,".")),[4,fetch(M+"/api/script/active?publicApiKey=".concat(N,"&hostname=").concat(window.location.hostname))];case 1:if(!(r=u.sent()).ok)throw new mn("[Optibase] Error occurred while fetching active.");return[4,r.json()];case 2:return e("getInitialize","Active response:",i=u.sent()),i.active?(window.optibaseSubscriptionPlan=i.subscriptionPlan,e("getInitialize","Calling with body:",o={publicApiKey:N,testedUserId:W,entryUrl:V,screenSize:j,browser:U,OS:z,topReferrer:$,testsOnPage:t,conversionsOnPage:n}),[4,fetch(M+"/api/script/initialize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o),credentials:"include"}).catch((function(){}))]):[2,{userNotLoggedIn7Days:!0,randomSeed:Math.floor(1e9*Math.random())}];case 3:if(!(s=u.sent()))throw new mn("[Optibase] Error occurred while fetching initialize.");return s.ok?[3,6]:[4,s.json().catch((function(){}))];case 4:return a=u.sent(),[4,s.text().catch((function(){}))];case 5:throw u.sent(),400!==s.status||a.clientError?500===s.status?new mn("[Optibase] Response not ok when calling getInitialize: "+(null==a?void 0:a.message)||0):new Error("[Optibase] Response not ok when calling getInitialize: "+(null==a?void 0:a.message)||0):new mn("[Optibase] Response not ok when calling getInitialize: "+(null==a?void 0:a.message)||0);case 6:return[4,s.json()];case 7:return e("getInitialize","Response:",c=u.sent()),[2,c]}}))}))}var d=0;function p(){var e=Math.pow(2,32);return(d=(1664525*d+1013904223)%e)/e}function f(e){var t=e.standaloneHeatmaps||[];if(!t.length)return window.optibaseManualHeatmapUrls=[],[];var n=t.filter((function(e){try{return a(e.url)===B}catch(e){return!1}}));return window.optibaseManualHeatmapUrls=n.map((function(e){return e.url})),n}function h(e){var t=e.standaloneRecordings||[];if(!t.length)return window.optibaseManualRecordingUrls=[],[];var n=t.filter((function(e){try{return a(e.url)===B}catch(e){return!1}}));return window.optibaseManualRecordingUrls=n.map((function(e){return e.url})),n}function g(i,o,s){return hn(this,void 0,void 0,(function(){var a,c,l,p,g,y,O,C,T,A,F,L,U,z,j,$;return gn(this,(function(V){switch(V.label){case 0:if(i.monthlyTestedUsersLimitReached&&(window.monthlyTestedUsersLimitReached=!0,console.error("[Optibase] The Monthly Tested Users limit has been reached.")),i.noTestsOrConversionsOnPage&&(window.noTestsOrConversionsOnPage=!0,e("handleInitializeResponse","No tests or conversions found on the page.")),i.userNotLoggedIn7Days&&(window.userNotLoggedIn7Days=!0,console.error("handleInitializeResponse","The user has not logged in in the last 7 days, please log in again to start running tests. It might take up to 2h after logging in for the script to be active again.")),!i.randomSeed)throw new Error("[Optibase] Random seed not returned.");return a="optibaseCachedInitializeResponse-tests".concat(o,"-conversions").concat(s),null==x||x.setItem(a,JSON.stringify(i)),d=i.randomSeed,i.testedUserId&&(W=i.testedUserId,window.optibaseTestedUserId=W,null===(g=window.localStorage)||void 0===g||g.setItem("optibaseTestedUserId",i.testedUserId)),i.testedUserExternalId&&(K=i.testedUserExternalId,window.optibaseTestedUserExternalId=i.testedUserExternalId,null===(y=window.localStorage)||void 0===y||y.setItem("optibaseTestedUserExternalId",i.testedUserExternalId)),c=f(i),l=h(i),_((null===(O=i.tests)||void 0===O?void 0:O.filter((function(e){return e.eligible&&e.test.type===ln.SPLIT})))||[],!1,D,R)?[2]:(w((null===(C=i.tests)||void 0===C?void 0:C.filter((function(e){return e.eligible&&e.test.type===ln.AB})))||[],!1,D,R),S((null===(T=i.personalizations)||void 0===T?void 0:T.filter((function(e){return e.eligible})))||[],!1,D,R,i.countryCode),window.optibaseInitialized=!0,u(),p=(new Date).getTime()-k.getTime(),P?[3,2]:(function(t){e("handleClickConversions","Setting up click listeners.");var n=document.querySelectorAll("[data-optibase-click-conversion-id]");0!==n.length?(e("handleClickConversions","Found elements with click conversion attribute:",n),n.forEach((function(e){var n=e.getAttribute("data-optibase-click-conversion-id");t.find((function(e){return e.userFriendlyId===n}))?e.addEventListener("click",(function(t){return hn(this,void 0,void 0,(function(){var r,i;return gn(this,(function(o){switch(o.label){case 0:return"A"!==e.tagName?[3,2]:(t.preventDefault(),[4,E(n)]);case 1:return o.sent(),(i=(r=e).href)&&("_blank"===r.target?window.open(i,"_blank"):window.location.href=i),[3,3];case 2:E(n),o.label=3;case 3:return[2]}}))}))})):console.error('[Optibase] Error: Element with click conversion ID "'.concat(n,'" does not have a corresponding Click Conversion on the server.'))}))):e("handleClickConversions","No elements with click conversion attribute found.")}((null===(A=i.conversions)||void 0===A?void 0:A.filter((function(e){return e.type===dn.CLICK||e.type===dn.LEGACY_CLICK_SUBMIT})))||[]),function(t){e("handleSubmitConversions","Setting up submit listeners.");var n=document.querySelectorAll("[data-optibase-submit-conversion-id]");0!==n.length?(e("handleSubmitConversions","Found elements with submit conversion attribute:",n),n.forEach((function(n){var r=n.getAttribute("data-optibase-submit-conversion-id");if(t.find((function(e){return e.userFriendlyId===r})))if("FORM"!==n.tagName){e("handleSubmitConversions",'Element with submit conversion ID "'.concat(r,'" is not a form element. Waiting for form to be added to the DOM by adding an observer.'));var i=function(){var t=n.querySelector("form");if(!t){var i=n.querySelector("iframe");if(!i)return void e("handleSubmitConversions",'Element with submit conversion ID "'.concat(r,'" is not a form element, does not contain a form element, and is not an iframe.'));var a=i.contentDocument;if(!a)return void e("handleSubmitConversions",'[Optibase] iframe in element with submit conversion ID "'.concat(r,'" does not have a contentDocument.'));if(!(t=a.querySelector("form")))return void e("handleSubmitConversions",'[Optibase] iframe in element with submit conversion ID "'.concat(r,'" does not have a form element.'))}e("handleSubmitConversions",'Adding submit listener to the found form element for submit conversion ID "'.concat(r,'":'),t),o.disconnect(),t.addEventListener("submit",s)},o=new MutationObserver((function(t){e("handleSubmitConversions MutationObserver",'Found Mutations for submit conversion ID "'.concat(r,'":'),t),t.forEach((function(e){"childList"==e.type&&i()}))}));o.observe(n,{childList:!0,subtree:!0}),i()}else e("handleSubmitConversions",'Adding submit listener to the found form element for submit conversion ID "'.concat(r,'":'),n),n.addEventListener("submit",s);else console.error('[Optibase] Error: Element with submit conversion ID "'.concat(r,'" does not have a corresponding Submit Conversion on the server.'));function s(t){return hn(this,void 0,void 0,(function(){return gn(this,(function(i){switch(i.label){case 0:return e("handleSubmitConversions",'Handling submit event for conversion ID "'.concat(r,'".')),!n.getAttribute("action")||t.defaultPrevented?[3,2]:(t.preventDefault(),[4,E(r)]);case 1:return i.sent(),n.submit(),[3,3];case 2:E(r),i.label=3;case 3:return[2]}}))}))}}))):e("handleSubmitConversions","No elements with submit conversion attribute found.")}((null===(F=i.conversions)||void 0===F?void 0:F.filter((function(e){return e.type===dn.SUBMIT||e.type===dn.LEGACY_CLICK_SUBMIT})))||[]),function(t){e("handleScrollConversions","Setting up scroll listeners.");var n=t.filter((function(e){return b(e.url,e.sameOrigin,!1)}));if(0!==n.length){e("handleScrollConversions","Found scroll depth conversions:",n);var r=new Set;window.addEventListener("scroll",(function(){var t,i,o=(t=window.pageYOffset||document.documentElement.scrollTop,i=document.documentElement.scrollHeight,(t+window.innerHeight)/i*100);n.forEach((function(t){if(!r.has(t.userFriendlyId)){var n=function(e){var t=document.documentElement.scrollHeight;return e.scrollDepthUnit===pn.PERCENTAGE?e.scrollDepthValue:e.scrollDepthUnit===pn.PIXELS?e.scrollDepthValue/t*100:1/0}(t);o>=n&&(e("Scroll Depth Conversion Triggered","Conversion ID: ".concat(t.userFriendlyId)),E(t.userFriendlyId),r.add(t.userFriendlyId))}}))}),{passive:!0})}else e("handleScrollConversions","No scroll depth conversions found.")}((null===(L=i.conversions)||void 0===L?void 0:L.filter((function(e){return e.type===dn.SCROLL_DEPTH})))||[]),function(t){e("handleTimeOnPageConversions","Setting up time on page listeners.");var n=t.filter((function(e){return b(e.url,e.sameOrigin,!1)}));if(0!==n.length){e("handleTimeOnPageConversions","Found time on page conversions:",n);for(var r=function(t){setTimeout((function(){e("Time On Page Conversion Triggered","Conversion ID: ".concat(t.userFriendlyId)),E(t.userFriendlyId)}),1e3*t.timeOnPage)},i=0,o=n;i<o.length;i++)r(o[i])}else e("handleTimeOnPageConversions","No time on page conversions found.")}((null===(U=i.conversions)||void 0===U?void 0:U.filter((function(e){return e.type===dn.TIME_ON_PAGE})))||[]),[4,I(p)]));case 1:V.sent(),function(t){var n=this;e("handlePageViewConversion","Handling page view conversions."),0!==t.length?(e("handlePageViewConversion","Found page view conversions:",t),t.forEach((function(t){return hn(n,void 0,void 0,(function(){return gn(this,(function(n){switch(n.label){case 0:return b(t.url,t.sameOrigin,t.matchAllPaths)?(e("handlePageViewConversion","Sending page view conversion with userFriendlyId: ".concat(t.userFriendlyId,".")),[4,E(t.userFriendlyId)]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))}))):e("handlePageViewConversion","No page view conversions found.")}((null===(z=i.conversions)||void 0===z?void 0:z.filter((function(e){return e.type===dn.PAGE_VIEW})))||[]),((null===(j=i.tests)||void 0===j?void 0:j.some((function(e){return e.test.heatmapsEnabled&&e.eligible})))||(null===($=i.personalizations)||void 0===$?void 0:$.some((function(e){return e.test.heatmapsEnabled&&e.eligible})))||c.length>0)&&t()&&v(M,N),(r(i.tests)||r(i.personalizations)||l.length>0)&&n()&&m(M,N),V.label=2;case 2:return e("handleInitializeResponse","Finished setting up Optibase. Time to setup: ".concat(p,"ms.")),[2]}}))}))}function v(t,n){if(e("loadHeatmapScript","Loading heatmap tracking script"),document.querySelector("script[data-optibase-heatmap]"))e("loadHeatmapScript","Heatmap script already loaded");else{var r=document.createElement("script");r.setAttribute("data-optibase-heatmap","true"),r.setAttribute("public-api-key",n),r.src="".concat(t,"/script-heatmap.js"),r.async=!0,r.onerror=function(){console.error("[Optibase] Failed to load heatmap script")},document.head.appendChild(r),e("loadHeatmapScript","Heatmap script loaded")}}function m(t,n){if(e("loadRecordingScript","Loading recording tracking script"),document.querySelector("script[data-optibase-recording]"))e("loadRecordingScript","Recording script already loaded");else{var r=document.createElement("script");r.setAttribute("data-optibase-recording","true"),r.setAttribute("public-api-key",n),r.src="".concat(t,"/script-recording.js"),r.async=!0,r.onerror=function(){console.error("[Optibase] Failed to load recording script")},document.head.appendChild(r),e("loadRecordingScript","Recording script loaded")}}function b(e,t,n){if(!e)return!1;var r=t?H:B;return n?r.startsWith(e):r===e}function y(e,t){for(var n=e.reduce((function(e,t){return e+(t.trafficSplitWeight||0)}),0),r=t*n,i=0,o=e;i<o.length;i++){var s=o[i];if((r-=s.trafficSplitWeight||0)<=0)return s}return e[e.length-1]}function _(t,n,r,i){var o=n?"handleSplitTests cached":"handleSplitTests";e(o,"Handling Split Tests splitTests:",t,"fromCached",n);for(var s=null,a=!1,c=!1,u=null,l=function(t){e(o,"Checking split test:",t);var l=t.test.variants.find((function(e){return e.main})),d=l.url,f=l.sameOrigin,h=p();if(e(o,"Checking if URL matches the current origin. entryUrl: ".concat(d,", sameOrigin: ").concat(f,".")),b(d,f,!1))if(e(o,"URL matches the current origin. Checking for a variant to run."),u=t,(null==r?void 0:r.userFriendlyTestId)===t.test.userFriendlyId){var g=t.test.variants.findIndex((function(e){return e.userFriendlyId===(null==r?void 0:r.userFriendlyVariantId)}));-1!==g&&(s=t.test.variants[g],a=!0,c=!0,e(o,"Selected preview variant:",s))}else if(i.length){var v=t.test.variants.findIndex((function(e){return i.find((function(t){return t.userFriendlyVariantId===e.userFriendlyId&&t.userFriendlyTestId===(null==u?void 0:u.test.userFriendlyId)}))}));-1!==v&&(s=t.test.variants[v],a=!0,e(o,"Selected forced variant:",s))}else{if(P)return c=!0,e(o,"Skipping handling Split Tests because script is disabled."),{value:!1};if(t.test.winnerVariantFriendlyId){var m=t.test.variants.find((function(e){return e.userFriendlyId===t.test.winnerVariantFriendlyId}));if(!m)return console.error('[Optibase] Error: Winner Variant with ID "'.concat(t.test.winnerVariantFriendlyId,'" does not exist.')),{value:!1};c=!0,e(o,"Selected winner variant:",m),s=m,a=!0}else s=y(t.test.variants,h),e(o,"Selected random variant:",s)}if(!n&&!r&&!c){var _=t.test.variants.find((function(e){return b(e.url,f,!1)}));_&&(e(o,"Found a split test variant for the current page."),G.push({userFriendlyTestId:t.test.userFriendlyId,userFriendlyVariantId:_.userFriendlyId,heatmapsEnabled:t.test.heatmapsEnabled,recordingsEnabled:t.test.recordingsEnabled}))}},d=0,f=t;d<f.length;d++){var h=l(f[d]);if("object"==typeof h)return h.value}if(u&&s){e(o,"Found split test to run:",u);var g=u.test.variants.find((function(e){return e.shownBefore})),v=a?s:g||s;if(e(o,"Selected variant:",v),v.main)return e(o,"Not redirecting because selected variant is the current page."),!1;if(!r||a){if(!n){e(o,"Redirecting to ".concat(v.url,"."));var m=decodeURIComponent(v.url);window.location.href=m+window.location.search}return!0}return!0}return e(o,"Found no split test to run."),!1}function w(t,n,r,i){var o=n?"handleABTests cached":"handleABTests";e(o,"Handling A/B Tests abTests:",t," fromCached:",n);var s=document.querySelectorAll("[data-optibase-test-id]");if(0!==s.length){var a=new Map;s.forEach((function(e){var r=e.getAttribute("data-optibase-test-id"),i=e.getAttribute("data-optibase-variant-id");if(r)if(i){if(!e.getAttribute("data-optibase-personalization-id")){var o=null==t?void 0:t.find((function(e){return e.test.userFriendlyId===r}));o?o.test.variants.find((function(e){return e.userFriendlyId===i}))?(a.has(r)||a.set(r,[]),a.get(r).push(e)):n&&console.error("[Optibase] Error: Element on the site is not part of any test. Invalid Variant ID: ".concat(i)):n||console.error("[Optibase] Error: Element on the site is not part of any test. Invalid Test ID: ".concat(r))}}else console.error("[Optibase] Error: Element on the site missing 'data-optibase-variant-id' attribute. Test ID: ".concat(r))})),e(o,"Found elements for A/B Tests:",a),a.forEach((function(s,a){var c=null==t?void 0:t.find((function(e){return e.test.userFriendlyId===a}));e(o,"Handling A/B test with userFriendlyId: ".concat(a,".")),c&&!c.eligible&&e(o,"Test is not eligable bacause: ".concat(c.reason));var u=[],l=null==c?void 0:c.test.variants.find((function(e){return e.main})),d=s.filter((function(e){return(null==l?void 0:l.userFriendlyId)&&e.getAttribute("data-optibase-variant-id")===l.userFriendlyId})),f=s.filter((function(e){return i.some((function(t){return e.getAttribute("data-optibase-variant-id")===t.userFriendlyVariantId&&a===t.userFriendlyTestId}))})),h=s.filter((function(e){return(null==r?void 0:r.userFriendlyVariantId)&&e.getAttribute("data-optibase-variant-id")===r.userFriendlyVariantId&&(null==c?void 0:c.test.userFriendlyId)===(null==r?void 0:r.userFriendlyTestId)})),g=s.filter((function(e){return(null==c?void 0:c.test.winnerVariantFriendlyId)&&e.getAttribute("data-optibase-variant-id")===c.test.winnerVariantFriendlyId})),v=!1;if(h.length)e(o,"Selecting the preview variant."),v=!0,u=h;else if(f.length)e(o,"Selecting the forced variant."),u=f;else if(P&&d.length)e(o,"Selecting the main variant by default because the script is disabled."),v=!0,u=d;else if(g.length)e(o,"Selecting the winner variant."),v=!0,u=g;else if(!(null==c?void 0:c.eligible)&&d.length)e(o,"Selecting the main variant because test is not eligible."),v=!0,u=d;else{var m=null==c?void 0:c.test.variants.find((function(e){return e.shownBefore})),b=s.filter((function(e){return e.getAttribute("data-optibase-variant-id")===(null==m?void 0:m.userFriendlyId)}));if(b.length)u=b;else{var _=p(),w=Array.from(new Set(s.map((function(e){return e.getAttribute("data-optibase-variant-id")})))),S=w.map((function(e){var t=null==c?void 0:c.test.variants.find((function(t){return t.userFriendlyId===e}));return{userFriendlyVariantId:e,trafficSplitWeight:(null==t?void 0:t.trafficSplitWeight)||0}}));e(o,"Selecting random variant from ".concat(w.length," unique variants:"),S);var E=y(S,_).userFriendlyVariantId;e(o,"Selected random variant:",E),u=s.filter((function(e){return e.getAttribute("data-optibase-variant-id")===E}))}}var I=u[0].getAttribute("data-optibase-variant-id");e(o,"Selected variant with userFriendlyVariantId: ".concat(I,". Elements:"),u),r||P||!(null==c?void 0:c.eligible)||v||n||G.push({userFriendlyTestId:a,userFriendlyVariantId:I,heatmapsEnabled:null==c?void 0:c.test.heatmapsEnabled,recordingsEnabled:null==c?void 0:c.test.recordingsEnabled});for(var O=0,x=u;O<x.length;O++){var C=x[O];"none"===C.style.display&&(C.style.display="")}for(var k=0,T=s;k<T.length;k++){var A=T[k];A.getAttribute("data-optibase-variant-id")!==I&&(n?A.style.display="none":A.remove())}}))}else e(o,"No elements with A/B testing attributes found.")}function S(t,n,r,i,o){var s=n?"handlePersonalizations cached":"handlePersonalizations";e(s,"Handling Personalizations personalizations:",t," fromCached:",n);var a=document.querySelectorAll("[data-optibase-personalization-id]");if(0!==a.length){var c=new Map;a.forEach((function(e){var r=e.getAttribute("data-optibase-personalization-id"),i=e.getAttribute("data-optibase-variant-id");if(r)if(i){var o=null==t?void 0:t.find((function(e){return e.test.userFriendlyId===r}));o?o.test.variants.find((function(e){return e.userFriendlyId===i}))?(c.has(r)||c.set(r,[]),c.get(r).push(e)):n&&console.error("[Optibase] Error: Element on the site is not part of any personalization. Invalid Variant ID: ".concat(i)):n||console.error("[Optibase] Error: Element on the site is not part of any personalization. Invalid Personalization ID: ".concat(r))}else console.error("[Optibase] Error: Element on the site missing 'data-optibase-variant-id' attribute. Personalization ID: ".concat(r))})),e(s,"Found elements for Personalizations:",c),c.forEach((function(a,c){var u,l=null==t?void 0:t.find((function(e){return e.test.userFriendlyId===c}));if(l){e(s,"Handling personalization with userFriendlyId: ".concat(c,".")),l&&!l.eligible&&e(s,"Personalization is not eligible because: ".concat(l.reason));var d=[];if(l&&l.test.personalizationRules)if(2===l.test.variants.length){var p=l.test.variants.find((function(e){return e.userFriendlyId.includes("main_variant")||e.userFriendlyId.endsWith("_main")}))||l.test.variants[0],f=l.test.variants.find((function(e){return e.userFriendlyId.includes("personalized_variant")||e.userFriendlyId.endsWith("_personalized")}))||l.test.variants[1];if(p&&f)if(p.userFriendlyId!==f.userFriendlyId){var h=a.filter((function(e){return e.getAttribute("data-optibase-variant-id")===p.userFriendlyId})),g=a.filter((function(e){return e.getAttribute("data-optibase-variant-id")===f.userFriendlyId})),v=l.test.variants.find((function(e){return e.shownBefore})),m=v?a.filter((function(e){return e.getAttribute("data-optibase-variant-id")===v.userFriendlyId})):[],b=a.filter((function(e){return i.some((function(t){return e.getAttribute("data-optibase-variant-id")===t.userFriendlyVariantId&&c===t.userFriendlyTestId}))})),y=a.filter((function(e){return(null==r?void 0:r.userFriendlyVariantId)&&e.getAttribute("data-optibase-variant-id")===r.userFriendlyVariantId&&(null==l?void 0:l.test.userFriendlyId)===(null==r?void 0:r.userFriendlyTestId)})),_=!1;if(y.length)e(s,"Selecting the preview variant."),_=!0,d=y;else if(b.length)e(s,"Selecting the forced variant."),d=b;else if(P&&h.length)e(s,"Selecting the main variant by default because the script is disabled."),_=!0,d=h;else if(!(null==l?void 0:l.eligible)&&h.length)e(s,"Selecting the main variant because personalization is not eligible."),_=!0,d=h;else if(m.length)e(s,"Selecting the previously shown variant: ".concat(null==v?void 0:v.userFriendlyId)),d=m;else{var w=function(t,n,r){var i="evaluatePersonalizationRules",o=r?"[Personalization: ".concat(r,"]"):"[Personalization]";if(e(i,"".concat(o," Evaluating rules:"),t),e(i,"".concat(o," User metadata:"),n),!t.condition)return e(i,"".concat(o," No condition specified, returning false")),!1;var s=[],a=[];if(t.location&&t.location.value.length>0){var c=Boolean(n.countryCode&&t.location.value.includes(n.countryCode)),u="is"===t.location.condition?c:!c;s.push(u),a.push({rule:"location",result:u,details:"Location ".concat(t.location.condition," ").concat(t.location.value.join(", ")," | User: ").concat(n.countryCode||"undefined"," | Match: ").concat(c)}),e(i,"".concat(o," Location rule - Condition: ").concat(t.location.condition,", Values: ").concat(t.location.value.join(", "),", User: ").concat(n.countryCode||"undefined",", Matches: ").concat(c,", Result: ").concat(u))}if(t.browser&&t.browser.value.length>0&&(c=Boolean(n.browser&&t.browser.value.includes(n.browser)),u="is"===t.browser.condition?c:!c,s.push(u),a.push({rule:"browser",result:u,details:"Browser ".concat(t.browser.condition," ").concat(t.browser.value.join(", ")," | User: ").concat(n.browser||"undefined"," | Match: ").concat(c)}),e(i,"".concat(o," Browser rule - Condition: ").concat(t.browser.condition,", Values: ").concat(t.browser.value.join(", "),", User: ").concat(n.browser||"undefined",", Matches: ").concat(c,", Result: ").concat(u))),t.operatingSystem&&t.operatingSystem.value.length>0&&(c=Boolean(n.OS&&t.operatingSystem.value.includes(n.OS)),u="is"===t.operatingSystem.condition?c:!c,s.push(u),a.push({rule:"operatingSystem",result:u,details:"OS ".concat(t.operatingSystem.condition," ").concat(t.operatingSystem.value.join(", ")," | User: ").concat(n.OS||"undefined"," | Match: ").concat(c)}),e(i,"".concat(o," OS rule - Condition: ").concat(t.operatingSystem.condition,", Values: ").concat(t.operatingSystem.value.join(", "),", User: ").concat(n.OS||"undefined",", Matches: ").concat(c,", Result: ").concat(u))),t.screenSize&&t.screenSize.value.length>0&&(c=t.screenSize.value.includes(n.screenSize),u="is"===t.screenSize.condition?c:!c,s.push(u),a.push({rule:"screenSize",result:u,details:"ScreenSize ".concat(t.screenSize.condition," ").concat(t.screenSize.value.join(", ")," | User: ").concat(n.screenSize," | Match: ").concat(c)}),e(i,"".concat(o," ScreenSize rule - Condition: ").concat(t.screenSize.condition,", Values: ").concat(t.screenSize.value.join(", "),", User: ").concat(n.screenSize,", Matches: ").concat(c,", Result: ").concat(u))),0===s.length)return e(i,"".concat(o," No rules to evaluate, returning false")),!1;var l=!1;return"any"===t.condition||"some"===t.condition?(l=s.some((function(e){return!0===e})),e(i,"".concat(o," Condition: ").concat(t.condition.toUpperCase()," (any/some) - Rule results: [").concat(s.join(", "),"], Final: ").concat(l))):"all"===t.condition?(l=s.every((function(e){return!0===e})),e(i,"".concat(o," Condition: ALL - Rule results: [").concat(s.join(", "),"], Final: ").concat(l))):"none"===t.condition?(l=!s.some((function(e){return!0===e})),e(i,"".concat(o," Condition: NONE - Rule results: [").concat(s.join(", "),"], Final: ").concat(l))):(e(i,"".concat(o," Unknown condition type: ").concat(t.condition,", defaulting to false")),l=!1),e(i,"".concat(o," Rules Evaluation Summary:"),{condition:t.condition,ruleDetails:a,ruleResults:s,finalResult:l}),l}(l.test.personalizationRules,{countryCode:o,browser:U,OS:z,screenSize:j},c);e(s,"".concat(c," - Rules evaluation result: ").concat(w?"MATCH ":"NO MATCH ")),w?g.length>0?(d=g,e(s,"".concat(c," - Rules matched . Showing personalized variant."))):(console.warn("[Optibase] Warning: Rules matched for ".concat(c," but no personalized variant elements found on page. Falling back to main variant.")),d=h):(d=h,e(s,"".concat(c," - Rules did not match . Showing main variant.")))}0===d.length&&(e(s,"".concat(c," - No variant elements found. Showing main variant as fallback.")),d=h);var S=(null===(u=d[0])||void 0===u?void 0:u.getAttribute("data-optibase-variant-id"))||p.userFriendlyId;e(s,"Selected variant with userFriendlyVariantId: ".concat(S,". Elements:"),d),r||P||!(null==l?void 0:l.eligible)||_||n||G.push({userFriendlyTestId:c,userFriendlyVariantId:S,heatmapsEnabled:null==l?void 0:l.test.heatmapsEnabled,recordingsEnabled:null==l?void 0:l.test.recordingsEnabled});for(var E=0,I=d;E<I.length;E++){var O=I[E];"none"===O.style.display&&(O.style.display="")}for(var x=0,C=a;x<C.length;x++){var k=C[x];k.getAttribute("data-optibase-variant-id")!==S&&(n?k.style.display="none":k.remove())}}else console.error("[Optibase] Error: Main and personalized variants have the same ID for ".concat(c));else console.error("[Optibase] Error: Could not identify main and personalized variants for ".concat(c,". Variant IDs: ").concat(l.test.variants.map((function(e){return e.userFriendlyId})).join(", ")))}else console.error("[Optibase] Error: Personalization must have exactly 2 variants. Found ".concat(l.test.variants.length,"."));else e(s,"Personalization rules not found. Skipping.")}else console.error("[Optibase] Error: Personalization ".concat(c," not found in personalizations array"))}))}else e(s,"No elements with personalization attributes found.")}function E(t){return hn(this,void 0,void 0,(function(){var n,r,i,o;return gn(this,(function(s){switch(s.label){case 0:if(!N)throw new Error("[Optibase] publicApiKey is undefined");if(!W)throw new Error("[Optibase] testedUserId is undefined");s.label=1;case 1:return s.trys.push([1,7,,8]),e("sendConversionEvent","Calling with body:",n={publicApiKey:N,testedUserId:W,userFriendlyConversionId:t,originUrl:V,samePageVariants:G}),[4,fetch("".concat(M,"/api/script/conversionEvent"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).catch((function(e){console.error("[Optibase] Error occurred while fetching conversionEvent. Details:",e)}))];case 2:return(r=s.sent())?r.ok?[3,5]:[4,r.json().catch((function(){}))]:[2];case 3:return i=s.sent(),[4,r.text().catch((function(){}))];case 4:throw s.sent(),400!==r.status||i.clientError?500===r.status?new mn("[Optibase] Response not ok when calling conversionEvent: "+(null==i?void 0:i.message)||0):new Error("[Optibase] Response not ok when calling conversionEvent: "+(null==i?void 0:i.message)||0):new mn("[Optibase] Response not ok when calling conversionEvent: "+(null==i?void 0:i.message)||0);case 5:return[4,r.json()];case 6:return e("sendConversionEvent","Response: ",s.sent()),[3,8];case 7:return(o=s.sent())instanceof mn||null==vn||vn.captureException(o),console.error("[Optibase] Error occurred while sending a conversion event. Details:",o),[3,8];case 8:return[2]}}))}))}function I(t){return hn(this,void 0,void 0,(function(){var n,r,a,c,u,l,d,p,f,h,g;return gn(this,(function(v){switch(v.label){case 0:if(n=(null===(f=window.optibaseSubscriptionPlan)||void 0===f?void 0:f.includes("BUSINESS"))||(null===(h=window.optibaseSubscriptionPlan)||void 0===h?void 0:h.includes("PROFESSIONAL"))||(null===(g=window.optibaseSubscriptionPlan)||void 0===g?void 0:g.includes("CUSTOM")),0===G.length&&!n)return e("sendView","No variants to send. Time to setup: ".concat(t,"ms.")),[2];if(!N)throw new Error("[Optibase] publicApiKey is undefined");if(!W)throw new Error("[Optibase] testedUserId is undefined");v.label=1;case 1:return v.trys.push([1,7,,8]),r=i(),a=o(),c=s(),u={publicApiKey:N,testedUserId:W,variants:G,originUrl:V,screenSize:c,OS:a,browser:r,timeToSetup:t},window.optibaseActiveVariants=G,O.forEach((function(e){return e(G)})),"function"==typeof window.gtag?G.forEach((function(t){!function(t){e("sendVariantToGA4","Sending variant ".concat(t.userFriendlyTestId+":"+t.userFriendlyVariantId," to GA4.")),window.gtag("event","optibase_variant_shown",{event_category:"optibase",event_label:t.userFriendlyTestId+":"+t.userFriendlyVariantId})}(t)})):e("sendVariantToGA4","Google Analytics (GA4) is not installed."),"undefined"!=typeof mixpanel&&"function"==typeof mixpanel.track?G.forEach((function(t){!function(t){e("sendVariantToMixpanel","Sending variant ".concat(t.userFriendlyTestId+":"+t.userFriendlyVariantId," to Mixpanel.")),mixpanel.track("optibase_variant_shown",{testId:t.userFriendlyTestId,variantId:t.userFriendlyTestId+":"+t.userFriendlyVariantId})}(t)})):e("sendVariantToMixpanel","Mixpanel is not installed."),e("sendView","Calling with body:",u),[4,fetch("".concat(M,"/api/script/view"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}).catch((function(e){console.error("[Optibase] Error occurred while fetching view. Details:",e)}))];case 2:return(l=v.sent())?l.ok?[3,5]:[4,l.json().catch((function(){}))]:[2];case 3:return d=v.sent(),[4,l.text().catch((function(){}))];case 4:throw v.sent(),400!==l.status||d.clientError?500===l.status?new mn("[Optibase] Response not ok when calling view: "+(null==d?void 0:d.message)||0):new Error("[Optibase] Response not ok when calling view: "+(null==d?void 0:d.message)||0):new mn("[Optibase] Response not ok when calling view: "+(null==d?void 0:d.message)||0);case 5:return[4,l.json()];case 6:return e("sendView","Response:",v.sent()),[3,8];case 7:return(p=v.sent())instanceof mn||null==vn||vn.captureException(p),console.error("[Optibase] Error occurred while sending a View. Details:",p),[3,8];case 8:return[2]}}))}))}window.optibaseSendConversionEvent=function(t){return hn(this,void 0,void 0,(function(){var n;return gn(this,(function(r){switch(r.label){case 0:if(e("handleProgrammaticConversion","Handling programmatic conversion with userFriendlyConversionId: ".concat(t,".")),!window.optibaseInitialized)return console.error("[Optibase] Did not send conversion event: Optibase did not fully initialize"),[2];if(window.monthlyTestedUsersLimitReached)return console.error("[Optibase] Did not send conversion event: Monthly Tested Users limit has been reached."),[2];if(window.noTestsOrConversionsOnPage)return console.error("[Optibase] Did not send conversion event: No tests or conversions found on the page. The conversion needs to be programmatic."),[2];if(window.userNotLoggedIn7Days)return console.error("[Optibase] Did not send conversion event: The user has not logged in in the last 7 days."),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,E(t)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),console.error("[Optibase] Error occurred while sending a conversion event. Details:",n),[3,4];case 4:return[2]}}))}))},window.optibaseSetTestedUserExternalId=function(t){return hn(this,void 0,void 0,(function(){var n,r,i,o;return gn(this,(function(s){switch(s.label){case 0:return e("setTestedUserExternalId","Setting tested user external ID:",t),window.monthlyTestedUsersLimitReached?(console.error("[Optibase] Did not set Tested User External ID: Monthly Tested Users limit has been reached."),[2]):window.userNotLoggedIn7Days?(console.error("[Optibase] Did not send conversion event: The user has not logged in in the last 7 days."),[2]):N?W?window.optibaseInitialized?(e("setTestedUserExternalId","Calling with body:",n={publicApiKey:N,testedUserId:W,testedUserExternalId:t}),[4,fetch("".concat(M,"/api/script/setTestedUserExternalId"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})]):(console.error("[Optibase] Did not set Tested User External ID: Optibase did not fully initialized."),[2]):(console.error("[Optibase] Did not set Tested User External ID: Tested User ID is not set. This user hasn't encountered any tests yet."),[2]):(console.error("[Optibase] Did not set Tested User External ID: Public API Key is not set."),[2]);case 1:if(!(r=s.sent()))throw new Error("[Optibase] Response not ok when calling setTestedUserExternalId: No response.");return r.ok?[3,4]:[4,r.json().catch((function(){}))];case 2:return i=s.sent(),[4,r.text().catch((function(){}))];case 3:throw s.sent(),400!==r.status||i.clientError?500===r.status?new mn("[Optibase] Response not ok when calling setTestedUserExternalId: "+(null==i?void 0:i.message)||0):new Error("[Optibase] Response not ok when calling setTestedUserExternalId: "+(null==i?void 0:i.message)||0):new mn("[Optibase] Response not ok when calling setTestedUserExternalId: "+(null==i?void 0:i.message)||0);case 4:return[4,r.json()];case 5:return o=s.sent(),K=t,window.optibaseTestedUserExternalId=t,null==x||x.setItem("optibaseTestedUserExternalId",t),e("setTestedUserExternalId","Response:",o),[2]}}))}))};var O=[];window.optibaseAddActiveVariantsListener=function(e){O.push(e),window.optibaseActiveVariants&&e(window.optibaseActiveVariants)};var x=null;try{(x=window.localStorage).getItem("optibase")}catch(e){x=null}window.optibaseScriptLoaded=!0;var C,k=null,T=!1,A=function(){var t=new URLSearchParams(window.location.search);T=Boolean(null==x?void 0:x.getItem("optibaseDebugMode")),t.has("optibaseEnableDebugMode")&&(e("getConfig","Params has optibaseEnableDebugMode; enabling debug mode."),null==x||x.setItem("optibaseDebugMode","true"),T=!0),t.has("optibaseDisableDebugMode")&&(e("getConfig","Params has optibaseDisableDebugMode; disabling debug mode."),null==x||x.removeItem("optibaseDebugMode"),T=!1);var n=null,r=[];if(t.has("optibasePreviewVariant")){var i=t.get("optibasePreviewVariant");e("getConfig","Params has optibasePreviewVariant:",i);var o=i.split(":"),s=o[0],a=o[1];s&&a?n={userFriendlyTestId:s,userFriendlyVariantId:a}:console.error('[Optibase] Error: Invalid optibasePreviewVariant format. It should be "userFriendlyTestId:userFriendlyVariantId".')}if(t.has("optibaseVariants")){var c=t.get("optibaseVariants");e("getConfig","Params has optibaseVariants:",c),c.split(";").map((function(e){return e.split(":")})).forEach((function(e){var t=e[0],n=e[1];t&&n?r.push({userFriendlyTestId:t,userFriendlyVariantId:n}):console.error('[Optibase] Error: Invalid optibaseVariants format. It should be "userFriendlyTestId:userFriendlyVariantId".')}))}var u=Boolean(null==x?void 0:x.getItem("optibaseScriptDisabled"));return t.has("optibaseDisableScript")?(e("getConfig","Params has optibaseDisableScript; disabling script."),null==x||x.setItem("optibaseScriptDisabled","true"),u=!0):t.has("optibaseEnableScript")?(e("getConfig","Params has optibaseEnableScript; enabling script."),null==x||x.removeItem("optibaseScriptDisabled"),u=!1):n&&(e("getConfig","Disabling script to show the preview variant."),u=!0),e("getConfig","Found scriptDisabled: ".concat(u,", debugMode: ").concat(T,", previewVariant:"),n,"and forcedVariants:",r),{scriptDisabled:u,previewVariant:n,forcedVariants:r}}(),P=A.scriptDisabled,D=A.previewVariant,R=A.forcedVariants;C=navigator.userAgent,Boolean(C)&&function(){if(rn instanceof RegExp)return rn;try{rn=new RegExp(" daum[ /]| deusu/|(?:^|[^g])news(?!sapphire)|(?<! (?:channel/|google/))google(?!(app|/google| pixel))|(?<! cu)bots?(?:\\b|_)|(?<!(?:lib))http|(?<![hg]m)score|(?<!cam)scan|24x7|@[a-z][\\w-]+\\.|\\(\\)|\\.com\\b|\\btime/|\\||^<|^[\\w \\.\\-\\(?:\\):%]+(?:/v?\\d+(?:\\.\\d+)?(?:\\.\\d{1,10})*?)?(?:,|$)|^[^ ]{50,}$|^\\d+\\b|^\\w*search\\b|^\\w+/[\\w\\(\\)]*$|^active|^ad muncher|^amaya|^avsdevicesdk/|^azure|^biglotron|^bot|^bw/|^clamav[ /]|^client/|^cobweb/|^custom|^ddg[_-]android|^discourse|^dispatch/\\d|^downcast/|^duckduckgo|^email|^facebook|^getright/|^gozilla/|^hobbit|^hotzonu|^hwcdn/|^igetter/|^jeode/|^jetty/|^jigsaw|^microsoft bits|^movabletype|^mozilla/\\d\\.\\d\\s[\\w\\.-]+$|^mozilla/\\d\\.\\d\\s\\(compatible;?(?:\\s\\w+\\/\\d+\\.\\d+)?\\)$|^navermailapp|^netsurf|^offline|^openai/|^owler|^php|^postman|^python|^rank|^read|^reed|^rest|^rss|^snapchat|^space bison|^svn|^swcd |^taringa|^thumbor/|^track|^w3c|^webbandit/|^webcopier|^wget|^whatsapp|^wordpress|^xenu link sleuth|^yahoo|^yandex|^zdm/\\d|^zoom marketplace/|agent|analyzer|archive|ask jeeves/teoma|audit|bit\\.ly/|bluecoat drtr|browsex|burpcollaborator|capture|catch|check\\b|checker|chrome-lighthouse|chromeframe|classifier|cloudflare|convertify|crawl|cypress/|dareboost|datanyze|dejaclick|detect|dmbrowser|download|evc-batch/|exaleadcloudview|feed|fetcher|firephp|functionize|grab|headless|httrack|hubspot marketing grader|hydra|ibisbrowser|infrawatch|insight|inspect|iplabel|java(?!;)|library|linkcheck|mail\\.ru/|manager|measure|neustar wpm|node|nutch|offbyone|onetrust|optimize|pageburst|pagespeed|parser|perl|phantomjs|pingdom|powermarks|preview|proxy|ptst[ /]\\d|retriever|rexx;|rigor|rss\\b|scrape|server|sogou|sparkler/|speedcurve|spider|splash|statuscake|supercleaner|synapse|synthetic|tools|torrent|transcoder|url|validator|virtuoso|wappalyzer|webglance|webkit2png|whatcms/|xtate/","i")}catch(e){rn=on}return rn}().test(C)&&(e("botDetection","Detected bot user agent."),P=!0);var F=function(){var t,n,r=document.currentScript;if(!r)throw new Error("[Optibase] Javascript not running withing a script.");var i=null!==(t=r.getAttribute("public-api-key"))&&void 0!==t?t:r.getAttribute("data-public-api-key");if(!i)throw new mn("[Optibase] Error: Missing public-api-key attribute in script tag.");var o=r.getAttribute("src");if(!o)throw new Error("[Optibase] Error: Missing src attribute in script tag.");var s=null;try{s=new URL(o)}catch(e){}if(!s)throw new mn("[Optibase] Error: Invalid src attribute in script tag. It should be a valid URL. Current is url: "+o);var a="".concat(s.protocol,"//").concat(s.hostname).concat(s.port?":"+s.port:""),c=!0;return r.async&&(console.error("[Optibase] Script is running as async. Remove async from the script."),c=!1),r.defer&&(console.error("[Optibase] Script is running as defer. Remove defer from the script."),c=!1),"HEAD"!==(null===(n=r.parentNode)||void 0===n?void 0:n.nodeName)&&(console.error("[Optibase] Script is not in the head element. Move the script to the <head> element."),c=!1),e("validateExecution","Found publicApiKey: ".concat(i,", baseApiUrl: ").concat(a,", and canHideBody: ").concat(c,".")),{publicApiKey:i,baseApiUrl:a,canHideBody:c}}(),N=F.publicApiKey,M=F.baseApiUrl,L=F.canHideBody,U=i(),z=o(),j=s();window.optibaseScreenSize=j;var $=function(){var t,n,r;try{r=null===(n=null===(t=null===window||void 0===window?void 0:window.frames)||void 0===t?void 0:t.top)||void 0===n?void 0:n.document.referrer}catch(e){r=void 0}return e("metadata","Current Top Refferer: ".concat(r,".")),r}();ie("browser",U),ie("os",z);var V=function(){var t=window.location.origin+window.location.pathname;return e("metadata","Current Origin Url: ".concat(t,".")),t}(),B=a(V),H=function(e){try{return new URL(e.startsWith("http")?e:"https://".concat(e)).pathname}catch(e){return null}}(V),W=null==x?void 0:x.getItem("optibaseTestedUserId");window.optibaseTestedUserId=W;var K=null==x?void 0:x.getItem("optibaseTestedUserExternalId");window.optibaseTestedUserExternalId=K;var G=[];function Y(){return hn(this,void 0,void 0,(function(){var i,o,s,a,c,p,b;return gn(this,(function(y){switch(y.label){case 0:return y.trys.push([0,3,,4]),e("onDOMContentLoaded","DOM Content Loaded"),k=new Date,i=document.querySelectorAll("[data-optibase-variant-id]"),o=document.querySelectorAll("[data-optibase-click-conversion-id]"),s=document.querySelectorAll("[data-optibase-submit-conversion-id]"),a=Boolean(i.length),c=Boolean(o.length)||Boolean(s.length),function(i,o){var s,a,c,l,p,g="optibaseCachedInitializeResponse-tests".concat(i,"-conversions").concat(o),b=null==x?void 0:x.getItem(g);if(b){var y=JSON.parse(b),E=f(y),I=h(y);if(e("handleCachedInitializeResponse","Detected cached getInitialize response for tests=".concat(i,", conversions=").concat(o,":"),y),!y.randomSeed)throw null==x||x.removeItem(g),new Error("[Optibase] Random seed not returned.");d=y.randomSeed,_((null===(s=y.tests)||void 0===s?void 0:s.filter((function(e){return e.eligible&&e.test.type===ln.SPLIT})))||[],!0,D,R)||(w((null===(a=y.tests)||void 0===a?void 0:a.filter((function(e){return e.eligible&&e.test.type===ln.AB})))||[],!0,D,R),S((null===(c=y.personalizations)||void 0===c?void 0:c.filter((function(e){return e.eligible})))||[],!0,D,R,y.countryCode),u(),P||(((null===(l=y.tests)||void 0===l?void 0:l.some((function(e){return e.test.heatmapsEnabled&&e.eligible})))||(null===(p=y.personalizations)||void 0===p?void 0:p.some((function(e){return e.test.heatmapsEnabled&&e.eligible})))||E.length>0)&&t()&&v(M,N),(r(y.tests)||r(y.personalizations)||I.length>0)&&n()&&m(M,N)))}else e("handleCachedInitializeResponse","No cached getInitialize response for tests=".concat(i,", conversions=").concat(o))}(a,c),Boolean(i.length)||e("onDOMContentLoaded","No variants found on the page."),Boolean(o.length)||e("onDOMContentLoaded","No click conversions found on the page."),Boolean(s.length)||e("onDOMContentLoaded","No submit conversions found on the page."),[4,l(a,c)];case 1:return p=y.sent(),e("getInitialize","Received response"),[4,g(p,a,c)];case 2:return y.sent(),[3,4];case 3:return(b=y.sent())instanceof mn||null==vn||vn.captureException(b),console.error("[Optibase] Encountered an error:",b),window.optibaseInitialized=!0,u(),[3,4];case 4:return[2]}}))}))}L&&(e("hideBody","Hiding body."),c.innerHTML="body { visibility: hidden !important; }",document.head.appendChild(c),setTimeout((function(){u()}),5e3)),"loading"!==document.readyState?Y():document.addEventListener("DOMContentLoaded",Y)}()}catch(E){throw E instanceof mn||null==vn||vn.captureException(E),E}})();
//# sourceMappingURL=script.js.map
//# debugId=e5499b48-ffe4-564d-9c3b-070c2ed3b8bf
